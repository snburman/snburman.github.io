(()=>{var u=class{constructor(){this.ws=null,this.addr=void 0,this.key=void 0;let t=localStorage.getItem("fncmp_key");t||(t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var i=Math.random()*16|0,o=n=="x"?i:i&3|8;return o.toString(16)}),localStorage.setItem("fncmp_key",t)),this.key=t;let r=window.location.pathname.split(""),s="";(r[-1]=="/"||r.length==1&&r[0]=="/")&&r.pop(),s=r.join(""),s==""&&(s="/"),this.addr="ws://"+window.location.host+s+"?fncmp_id="+this.key,this.connect()}connect(){try{this.ws=new WebSocket(this.addr)}catch(t){throw new Error("ws: failed to connect to server...")}this.ws.onopen=function(){},this.ws.onclose=function(){},this.ws.onerror=function(){},this.ws.onmessage=function(t){let r=JSON.parse(t.data);if(r.function=="ping"){r.ping.client=!0,this.send(JSON.stringify(r));return}y.Process(this,r)}}},f=class{constructor(){this.ws=null,this.Dispatch=t=>{if(t){if(!this.ws)throw new Error("ws: not connected to server...");this.ws.send(JSON.stringify(t))}},this.funs={render:t=>{let r=null,n=new DOMParser().parseFromString(t.render.html,"text/html").firstChild.getElementsByTagName("body")[0].innerHTML;if(t.render.tag!=""){if(r=document.getElementsByTagName(t.render.tag)[0],!r)return this.Error(t,"element with tag not found: "+t.render.tag)}else if(t.render.target_id!=""){if(r=document.getElementById(t.render.target_id),!r)return this.Error(t,"element with target_id not found: "+t.render.target_id)}else return this.Error(t,"no target or tag specified");if(t.render.inner&&(r.innerHTML=n),t.render.outer&&(r.outerHTML=n),t.render.append&&(r.innerHTML+=n),t.render.prepend&&(r.innerHTML=n+r.innerHTML),t.render.remove){r.remove();return}t=this.utils.parseEventListeners(r,t),this.Dispatch(this.utils.addEventListeners(t))},class:t=>{let r=document.getElementById(t.class.target_id);if(!r)return this.Error(t,"element not found");t.class.remove?r.classList.remove(...t.class.names):r.classList.add(...t.class.names)},custom:t=>(t.custom.result=window[t.custom.function](t.custom.data),t)},this.utils={parseEventListeners:(t,r)=>{let o=this.utils.getAttributes(t,"events").map(c=>{let d=JSON.parse(c);if(d)return d}).flat().filter(c=>c!=null);return r.render.event_listeners=o,r},parseFormData:(t,r)=>{let s=t.target,n=new FormData(s);return r.event.data=Object.fromEntries(n.entries()),r},getAttributes:(t,r)=>{let s=t.querySelectorAll("[".concat(r,"]"));return Array.from(s).map(n=>n.getAttribute(r))},addEventListeners:t=>{t.render.event_listeners&&t.render.event_listeners.forEach(r=>{let s=document.getElementById(r.target_id);if(!s){this.Error(t,"element not found");return}s.firstChild&&(s=s.firstChild),s.addEventListener(r.on,n=>{switch(n.preventDefault(),t.function="event",t.event=r,r.on){case"submit":t=this.utils.parseFormData(n,t);break;case"pointerdown":t.event.data=m(n);break;case"drag":t.event.data=h(n);break;case"mousedown":t.event.data=p(n);break;case"keydown":t.event.data=b(n);break;case"change":t.event.data=a(n.target);break;case"touchstart":t.event.data=g(n);break;default:t.event.data=a(n.target)}this.Dispatch(t)})})}},this.Error=(t,r)=>{t.function="error",t.error.message=r,this.Dispatch(t)}}Process(t,r){switch(this.ws||(this.ws=t),r.function){case"redirect":window.location.href=r.redirect.url;break;default:if(!this.funs[r.function]){this.Error(r,"function not found: "+r.function);break}let s=this.funs[r.function](r);this.Dispatch(s);break}}};function a(e){return{id:e.id||"",name:e.name||"",tagName:e.tagName||"",innerHTML:e.innerHTML||"",outerHTML:e.outerHTML||"",value:e.value||""}}function m(e){return{isTrusted:e.isTrusted,altKey:e.altKey,bubbles:e.bubbles,button:e.button,buttons:e.buttons,cancelable:e.cancelable,clientX:e.clientX,clientY:e.clientY,composed:e.composed,ctrlKey:e.ctrlKey,currentTarget:a(e.currentTarget),defaultPrevented:e.defaultPrevented,detail:e.detail,eventPhase:e.eventPhase,height:e.height,isPrimary:e.isPrimary,metaKey:e.metaKey,movementX:e.movementX,movementY:e.movementY,offsetX:e.offsetX,offsetY:e.offsetY,pageX:e.pageX,pageY:e.pageY,pointerId:e.pointerId,pointerType:e.pointerType,pressure:e.pressure,relatedTarget:a(e.relatedTarget)}}function g(e){return{changedTouches:Array.from(e.changedTouches).map(t=>l(t)),targetTouches:Array.from(e.targetTouches).map(t=>l(t)),touches:Array.from(e.touches).map(t=>l(t)),layerX:e.layerX,layerY:e.layerY,pageX:e.pageX,pageY:e.pageY}}function l(e){return{clientX:e.clientX,clientY:e.clientY,identifier:e.identifier,pageX:e.pageX,pageY:e.pageY,radiusX:e.radiusX,radiusY:e.radiusY,rotationAngle:e.rotationAngle,screenX:e.screenX,screenY:e.screenY,target:a(e.target)}}function h(e){return{isTrusted:e.isTrusted,altKey:e.altKey,bubbles:e.bubbles,button:e.button,buttons:e.buttons,cancelable:e.cancelable,clientX:e.clientX,clientY:e.clientY,composed:e.composed,ctrlKey:e.ctrlKey,currentTarget:a(e.currentTarget),defaultPrevented:e.defaultPrevented,detail:e.detail,eventPhase:e.eventPhase,metaKey:e.metaKey,movementX:e.movementX,movementY:e.movementY,offsetX:e.offsetX,offsetY:e.offsetY,pageX:e.pageX,pageY:e.pageY,relatedTarget:a(e.relatedTarget)}}function p(e){return{isTrusted:e.isTrusted,altKey:e.altKey,bubbles:e.bubbles,button:e.button,buttons:e.buttons,cancelable:e.cancelable,clientX:e.clientX,clientY:e.clientY,composed:e.composed,ctrlKey:e.ctrlKey,currentTarget:a(e.currentTarget),defaultPrevented:e.defaultPrevented,detail:e.detail,eventPhase:e.eventPhase,metaKey:e.metaKey,movementX:e.movementX,movementY:e.movementY,offsetX:e.offsetX,offsetY:e.offsetY,pageX:e.pageX,pageY:e.pageY,relatedTarget:a(e.relatedTarget)}}function b(e){return{isTrusted:e.isTrusted,altKey:e.altKey,bubbles:e.bubbles,cancelable:e.cancelable,code:e.code,composed:e.composed,ctrlKey:e.ctrlKey,currentTarget:a(e.currentTarget),defaultPrevented:e.defaultPrevented,detail:e.detail,eventPhase:e.eventPhase,isComposing:e.isComposing,key:e.key,location:e.location,metaKey:e.metaKey,repeat:e.repeat,shiftKey:e.shiftKey}}var y=new f;new u;})();
