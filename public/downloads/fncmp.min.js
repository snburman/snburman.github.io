(()=>{var l=class{constructor(t){this.ws=null;this.Dispatch=t=>{if(t){if(!this.ws)throw new Error("ws: not connected to server...");this.ws.send(JSON.stringify(t))}};this.funs={ping:t=>(t.ping.client=!0,t),render:t=>{let n=null,r=t.render.html;if(t.render.tag!=""){if(n=document.getElementsByTagName(t.render.tag)[0],!n)return this.Error(t,"element with tag not found: "+t.render.tag)}else if(t.render.target_id!=""){if(n=document.getElementById(t.render.target_id),!n)return this.Error(t,"element with target_id not found: "+t.render.target_id)}else return this.Error(t,"no target or tag specified");if(t.render.inner&&(n.innerHTML=r),t.render.outer&&(n.outerHTML=r),t.render.append&&(n.innerHTML+=r),t.render.prepend&&(n.innerHTML=r+n.innerHTML),t.render.remove){n.remove();return}t=this.utils.parseEventListeners(n,t),this.Dispatch(this.utils.addEventListeners(t))},class:t=>{let n=document.getElementById(t.class.target_id);if(!n)return this.Error(t,"element not found");t.class.remove?n.classList.remove(...t.class.names):n.classList.add(...t.class.names)},custom:t=>(t.custom.result=window[t.custom.function](t.custom.data),t)};this.utils={parseEventListeners:(t,n)=>{let s=this.utils.getAttributes(t,"events").map(i=>{let b=JSON.parse(i);if(b)return b}).flat().filter(i=>i!=null);return n.render.event_listeners=s,n},parseFormData:(t,n)=>{let r=t.target,a=new FormData(r);return n.event.data=Object.fromEntries(a.entries()),n},getAttributes:(t,n)=>{let r=t.querySelectorAll(`[${n}]`);return Array.from(r).map(a=>a.getAttribute(n))},addEventListeners:t=>{t.render.event_listeners&&t.render.event_listeners.forEach(n=>{let r=document.getElementById(n.target_id);if(!r){this.Error(t,"element not found");return}r.firstChild&&(r=r.firstChild),r.addEventListener(n.on,a=>{a.preventDefault(),t.function="event",t.event=n,["submit","change"].includes(n.on)?t=this.utils.parseFormData(a,t):["pointerdown","pointerup","pointermove","click","contextmenu","dblclick"].includes(n.on)?t.event.data=d(a):["drag","dragend","dragenter","dragexitcapture","dragleave","dragover","dragstart","drop"].includes(n.on)?t.event.data=f(a):["mousedown","mouseup","mousemove"].includes(n.on)?t.event.data=h(a):["keydown","keyup","keypress"].includes(n.on)?t.event.data=y(a):["input","invalid","reset","search","select","focus","blur","copy","cut","paste"].includes(n.on)?t.event.data=o(a.target):["touchstart","touchend","touchmove","touchcancel"].includes(n.on)?t.event.data=g(a):t.event.data=o(a.target),this.Dispatch(t)})})}};this.Error=(t,n)=>{t.function="error",t.error.message=n,this.Dispatch(t)};this.ws=t}Process(t){switch(t.function){case"redirect":window.location.href=t.redirect.url;break;default:if(!this.funs[t.function]){this.Error(t,"function not found: "+t.function);break}let n=this.funs[t.function](t);if(!n)break;this.Dispatch(n);break}}};function o(e){return{id:e.id||"",name:e.name||"",tagName:e.tagName||"",innerHTML:e.innerHTML||"",outerHTML:e.outerHTML||"",value:e.value||""}}function d(e){return{isTrusted:e.isTrusted,altKey:e.altKey,bubbles:e.bubbles,button:e.button,buttons:e.buttons,cancelable:e.cancelable,clientX:e.clientX,clientY:e.clientY,composed:e.composed,ctrlKey:e.ctrlKey,currentTarget:o(e.currentTarget),defaultPrevented:e.defaultPrevented,detail:e.detail,eventPhase:e.eventPhase,height:e.height,isPrimary:e.isPrimary,metaKey:e.metaKey,movementX:e.movementX,movementY:e.movementY,offsetX:e.offsetX,offsetY:e.offsetY,pageX:e.pageX,pageY:e.pageY,pointerId:e.pointerId,pointerType:e.pointerType,pressure:e.pressure,relatedTarget:o(e.relatedTarget)}}function g(e){return{changedTouches:Array.from(e.changedTouches).map(t=>c(t)),targetTouches:Array.from(e.targetTouches).map(t=>c(t)),touches:Array.from(e.touches).map(t=>c(t)),layerX:e.layerX,layerY:e.layerY,pageX:e.pageX,pageY:e.pageY}}function c(e){return{clientX:e.clientX,clientY:e.clientY,identifier:e.identifier,pageX:e.pageX,pageY:e.pageY,radiusX:e.radiusX,radiusY:e.radiusY,rotationAngle:e.rotationAngle,screenX:e.screenX,screenY:e.screenY,target:o(e.target)}}function f(e){return{isTrusted:e.isTrusted,altKey:e.altKey,bubbles:e.bubbles,button:e.button,buttons:e.buttons,cancelable:e.cancelable,clientX:e.clientX,clientY:e.clientY,composed:e.composed,ctrlKey:e.ctrlKey,currentTarget:o(e.currentTarget),defaultPrevented:e.defaultPrevented,detail:e.detail,eventPhase:e.eventPhase,metaKey:e.metaKey,movementX:e.movementX,movementY:e.movementY,offsetX:e.offsetX,offsetY:e.offsetY,pageX:e.pageX,pageY:e.pageY,relatedTarget:o(e.relatedTarget)}}function h(e){return{isTrusted:e.isTrusted,altKey:e.altKey,bubbles:e.bubbles,button:e.button,buttons:e.buttons,cancelable:e.cancelable,clientX:e.clientX,clientY:e.clientY,composed:e.composed,ctrlKey:e.ctrlKey,currentTarget:o(e.currentTarget),defaultPrevented:e.defaultPrevented,detail:e.detail,eventPhase:e.eventPhase,metaKey:e.metaKey,movementX:e.movementX,movementY:e.movementY,offsetX:e.offsetX,offsetY:e.offsetY,pageX:e.pageX,pageY:e.pageY,relatedTarget:o(e.relatedTarget)}}function y(e){return{isTrusted:e.isTrusted,altKey:e.altKey,bubbles:e.bubbles,cancelable:e.cancelable,code:e.code,composed:e.composed,ctrlKey:e.ctrlKey,currentTarget:o(e.currentTarget),defaultPrevented:e.defaultPrevented,detail:e.detail,eventPhase:e.eventPhase,isComposing:e.isComposing,key:e.key,location:e.location,metaKey:e.metaKey,repeat:e.repeat,shiftKey:e.shiftKey}}var E=!1,p,u=class{constructor(t){this.ws=null;this.addr=void 0;this.key=void 0;t?this.addr=t:this.init(),this.connect()}init(){let t=window.location.pathname.split(""),n="";(t[-1]=="/"||t.length==1&&t[0]=="/")&&t.pop(),n=t.join(""),n==""&&(n="/");let r=localStorage.getItem("fncmp");r||(r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(m){let s=Math.random()*16|0;return(m=="x"?s:s&3|8).toString(16)}),localStorage.setItem("fncmp",r));let a="wss";location.protocol!=="https:"&&(a="ws"),this.addr=a+"://"+window.location.host+n+"?fncmp_id="+this.key}connect(){try{this.ws=new WebSocket(this.addr)}catch(t){throw new Error("ws: failed to connect to fncmp server: "+t)}try{p=new l(this.ws)}catch(t){throw new Error("ws: failed to initiate API: "+t)}this.ws.onopen=function(){E=!0},this.ws.onclose=function(){setTimeout(()=>{typeof window<"u"&&window.location.reload()},1e3)},this.ws.onerror=function(){},this.ws.onmessage=function(t){let n=JSON.parse(t.data);p.Process(n)}}};new u;})();
